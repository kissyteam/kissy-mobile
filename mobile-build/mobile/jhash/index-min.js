(function(d){var j=d.document.documentMode,i="onhashchange"in d&&(void 0===j||7<j),g=d.jHash={jhash:"2.1",change:function(a){i?d.addEventListener?d.addEventListener("hashchange",a,!1):d.attachEvent?d.attachEvent("onhashchange",a):d.onhashchange+=a:h.push(a)},unbind:function(a){if(i)d.removeEventListener?d.removeEventListener("hashchange",a,!1):d.detachEvent?d.detachEvent("onhashchange",a):d.onhashchange-=a;else{var c=h,a=h.indexOf(a),b=c.slice(a+1||c.length);c.length=0>a?c.length+a:a;c.push.apply(c,
b)}return this},val:function(a,c){var b=g.query();return 2===arguments.length?(b[a.toLowerCase()]=null===c?"":c,this.set(this.root(),b)):1===arguments.length&&"string"===typeof a?b[a.toLowerCase()]:"object"===typeof a?this.set(this.root(),a):b},root:function(a){void 0===a?(a=d.location.hash,a=a.substring(0,a.length),-1<a.indexOf("#")&&(a=a.substring(1,a.length)),-1<a.indexOf("?")&&(a=a.substring(0,a.indexOf("?")))):a=this.set(a,this.val());return a},set:function(a,c){var b=null;if(null===a&&null===
c)b=null;else if(void 0!==c){var b=a,f;if("string"===typeof c)f=c;else{var e="";for(f in c)void 0!==c[f]&&(0<e.length&&(e+="&"),e+=f.toString()+"="+c[f].toString());f=e}0<f.length&&(b+="?");b+=f}else b=a;d.location.hash=b;return this},remove:function(a){var c=g.query();c[a.toLowerCase()]=void 0;return this.set(this.root(),c)},query:function(){var a=d.location.hash,c={},b=null,b=a.substring(0,a.length);if(null!==a&&void 0!==a&&(0===b.indexOf("#")&&(b=b.substring(1,b.length)),a=b.indexOf("?"),-1<a)){var b=
b.substring(a+1,b.length),a=b.split("&"),f;for(f in a)b=a[f].split("="),c[b[0].toString().toLowerCase()]=b[1]}return c},clear:function(){d.location.hash="";return this},clearQuery:function(){this.set(this.root());return this},clearRoot:function(){this.set("",this.query());return this},_routes:{},_routeHandlerRegistered:!1,_defaultRoute:null,route:function(a,c){this._routes[a]=c;this._routeHandlerRegistered||(this._routeHandlerRegistered=!0,g.change(k))},processRoute:function(){k()},defaultRoute:function(a,
c){if(0==arguments.length)return this._defaultRoute;this._defaultRoute={root:a,query:c}}};i||d.setInterval(function(){var a=d.location.hash;if(l!==a)for(var c in h)h[c].call(d);l=a},200);var h=[],l=d.location.hash,m=/{([\w\d]+)}/g,k=function(){var a=g.root(),c=g.defaultRoute();if(0===(a||"").length&&c)g.set(c.root,c.query);else for(var b in g._routes)if("string"===typeof b){var c=a,d=RegExp(b.replace(m,"([^/]+)")+"$"),c=c.match(d);if(null!==c){a=g._routes[b];d={};b=b.match(m);if(null!==b)for(var e=
0;e<b.length;e++){var h=b[e].substring(1).substring(0,b[e].length-2);d[h]=c[e+1]}a.call(d);break}}}})(window);
